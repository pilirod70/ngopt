#summary A brief tutorial describing how to score genome assemblies using the Mauve system

= Introduction =

Most assembly algorithms provide a large variety of parameters that can be adjusted to control the assembly process.  It may be necessary to tune these parameters to fit details of the sequencing strategy and genomes being assembled.  This document will illustrate how one can compare assemblies done by different algorithms or different parameter settings to select an ideal assembly strategy.  We assume that a high quality reference genome is available, and that sequence reads for that reference genome are available, and also that the reference genome is similar enough to the genomes being targeted for assembly that parameters which work well on the reference will also work well on the other genomes.


= Software requirements =

=== Mauve ===
Please obtain a copy of Mauve from here:
http://gel.ahabs.wisc.edu/mauve/snapshots/

=== Mauve Assembly Metrics === 
Then obtain a copy of the Mauve assembly metrics scripts from here:
http://ngopt.googlecode.com/svn/trunk/assemblathon

Alternatively these can be checked out using subversion:

{{{
svn checkout http://ngopt.googlecode.com/svn/trunk/assemblathon assemblathon-mauve
}}}
And they will need to be made executable prior to use:
{{{
chmod 755 assemblathon-mauve/*
}}}

=== R === 

You will also need the R statistical software, available from here:
http://r-project.org
It can be installed on Debian and Ubuntu distributions simply by running:
{{{
sudo apt-get install r-recommended
}}}


=== Java === 

Most computers already have Java installed.  Windows users mayneed to download and install it from http://java.sun.com

= Data requirements = 

  * A reference genome, either in FastA or GenBank format (preferred).  For the tutorial we will use Haloferax_volcanii_DS2.gbk

  * Some genome assemblies.  These can also be in FastA or GenBank formats.  For the tutorial we will use assembly1.fasta, assembly2.fasta, and assembly3.fasta


= Computing Mauve Assembly Metrics =

The following instructions assume you have downloaded and unpacked the Mauve software into a directory called mauve_snapshot_directory and have also downloaded the test data files [http://edhar.genomecenter.ucdavis.edu/~koadman/mauve_assembly_metrics/Haloferax_volcanii_DS2.gbk Haloferax_volcanii_DS2.gbk], [http://edhar.genomecenter.ucdavis.edu/~koadman/mauve_assembly_metrics/assembly1.fasta assembly1.fasta], [http://edhar.genomecenter.ucdavis.edu/~koadman/mauve_assembly_metrics/assembly2.fasta assembly2.fasta], and [http://edhar.genomecenter.ucdavis.edu/~koadman/mauve_assembly_metrics/assembly3.fasta assembly3.fasta] into that directory.  If these files exist in different locations it will be necessary to adjust the paths accordingly in the following commands.

  # Use Mauve to score each assembly
{{{
cd mauve_snapshot_directory

java -cp Mauve.jar org.gel.mauve.assembly.ScoreAssembly -reference Haloferax_volcanii_DS2.gbk -assembly assembly1.fasta -reorder assembly1_reorder -outputDir assembly1_scores

java -cp Mauve.jar org.gel.mauve.assembly.ScoreAssembly -reference Haloferax_volcanii_DS2.gbk -assembly assembly2.fasta -reorder assembly2_reorder -outputDir assembly2_scores

java -cp Mauve.jar org.gel.mauve.assembly.ScoreAssembly -reference Haloferax_volcanii_DS2.gbk -assembly assembly3.fasta -reorder assembly3_reorder -outputDir assembly3_scores
}}} 
  # Generate summary plots comparing the assemblies
{{{
assemblathonMauvePlots.pl ./
}}}
  # Visualize PDFs of accuracy plots.  A large number of PDFs will be generated in the current directory.  These plots can be used to decide on the assembly strategy that best meets your project's objectives.  For example, you may prefer the assembly with the highest fraction of coding regions reconstructed, or the assembly with the fewest structural errors, or the assembly that captures the true genomic content most precisely.



= A complete example on the Linux command line =


{{{
#
# Get the software
#
wget http://gel.ahabs.wisc.edu/mauve/snapshots/2011/2011-05-29/linux-x64/mauve_linux_snapshot_2011-05-29.tar.gz
tar xvzf mauve_linux_snapshot_2011-05-29.tar.gz
cd mauve_snapshot_2011-05-29/
wget http://ngopt.googlecode.com/svn/trunk/assemblathon/assemblathonMauvePlots.R
wget http://ngopt.googlecode.com/svn/trunk/assemblathon/assemblathonMauvePlots.pl
chmod 755 assemblathonMauvePlots.*

#
# Get the test data
#
wget http://edhar.genomecenter.ucdavis.edu/~koadman/mauve_assembly_metrics/Haloferax_volcanii_DS2.gbk
wget http://edhar.genomecenter.ucdavis.edu/~koadman/mauve_assembly_metrics/assembly1.fasta
wget http://edhar.genomecenter.ucdavis.edu/~koadman/mauve_assembly_metrics/assembly2.fasta
wget http://edhar.genomecenter.ucdavis.edu/~koadman/mauve_assembly_metrics/assembly3.fasta

#
# run the scoring
#
java -cp Mauve.jar org.gel.mauve.assembly.ScoreAssembly -reference Haloferax_volcanii_DS2.gbk -assembly assembly1.fasta -reorder assembly1_scores -outputDir assembly1_scores

java -cp Mauve.jar org.gel.mauve.assembly.ScoreAssembly -reference Haloferax_volcanii_DS2.gbk -assembly assembly2.fasta -reorder assembly2_scores -outputDir assembly2_scores

java -cp Mauve.jar org.gel.mauve.assembly.ScoreAssembly -reference Haloferax_volcanii_DS2.gbk -assembly assembly3.fasta -reorder assembly3_scores -outputDir assembly3_scores

#
# Generate plots of metrics
#
./assemblathonMauvePlots.pl ./

}}}

At this stage a set of PDF files named mauve_* will exist in the current directory.  These files can be inspected to evaluate assembly strategies.